{% extends 'vendors/base.html' %}
{% load bootstrap4 %}
{% load static %}


{% block vendor_content %}
<!-- <style>
    .vendorPic {
        height: 200px;
        width: 200px;
    }
</style> -->
{#{{vendor.slug}}#}
<!-- contents -->
<div class="container-lg p-0">
    <!-- top banner -->
    <div>
        <img class="w-100 h-100 img-fluid" src="{{ vendor.cover_image.url }}" alt="a happy picture, wedding">
    </div>
    <!-- main content -->
    <div class="container-fluid py-2 shadow" style="background-color:white;">
        <!-- vendor header -->
        <div class="row my-4 mx-3">
            <!-- vendor profile picture -->
            <div class="col-lg-2">
                <img class="vendorPic" src="{{ vendor.logo.url }}">
            </div>
            <!-- vendor name and review and add-to-checklist-->
            <div class="col-lg-8 mt-4 mx-5">
                <label class="h1"><strong>{{vendor.vendor_name}}</strong></label><br>
                <div class="">
                    <h4></h4>
                    <button class="fa fa-star my-btn checked"></button>
                    <button class="fa fa-star my-btn checked"></button>
                    <button class="fa fa-star my-btn checked"></button>
                    <button class="fa fa-star my-btn checked"></button>
                    <button class="fa fa-star my-btn"></button>
                </div>
                
                {% if user.is_customer %}
                  <div>
                    <button type="button" class="btn btn-danger btn-sm mt-3" data-toggle="modal" data-target="#staticBackdrop">Add to checklist</button>
                </div>
                {% endif %}
            </div>
        </div>
        <hr>
        <!--EO vendor profile header-->

        <!-- about space-->
        <div class="mx-3">
            <h3>About</h3><br>
            <p class="aboutUs">
                {{vendor.about|safe}}
            </p>
            <p class="mx-3">
                <label class="font-weight-normal h5">Contact us at:</label><br>
                <label class="user-select-all" id="vendorMobilePhone">+977 9801234567</label><br>
                <label class="user-select-all" id="vendorPhone">+01 48123456</label><br>
                <label class="user-select-all" id="vendorAddress">Ratopul, Kathmandu</label><br>
            </p>
        </div>
        <!-- media space-->
        <div class="mx-3">
            <h3>Media</h3><br>
            <!-- pictures -->
            <div class="container-fluid row rounded">
                <div class="col-lg-3">
                    <img class="card-img-top" src="{% static 'images/filler1.png' %}">
                </div>
                <div class="col-lg-3">
                    <img class="card-img-top" src="{% static 'images/filler1.png' %}">
                </div>
                <div class="col-lg-3">
                    <img class="card-img-top" src="{% static 'images/filler1.png' %}">
                </div>
                <div class="col-lg-3">
                    <img class="card-img-top" src="{% static 'images/filler1.png' %}">
                </div>
            </div>
        </div>
        <hr>
        <!--end of media space-->

        <!-- reviews given to vendor will be dipayed below -->
        <div class="reviews">

            {% include 'vendors/reviews.html' %}

        </div>

        {% if user.is_vendor and vendor.user.username == user.username %}
        {% for tag in tags %}
        {{tag}}
        {% endfor %}

        {% else %}

        {% endif %}



    {#{{vendor.slug}}#}

    <div class="container">

    <div class="cover-image">


    </div>

    <!-- this div tag contains vendor's profile picture and cover pictures inside it  -->
    <div class="pictures">
        <img src="{{ vendor.cover_image.url }}" class="cover_pic" alt="Cover Image">
        <img src="{{ vendor.logo.url }}" class="profile_pic" alt="Logo">
        <span class="vendor_name">{{vendor.vendor_name}}</span>
    </div>
    
    {% if user.is_vendor and vendor.user == user %}
      <div class="update-logo">
        <button type="button" class="btn btn-primary" id="logo-button-show">Edit Logo</button>
        <button type="button" class="btn btn-primary" id="logo-button-hide">Close</button>
        <form method="POST" id="logo-form" action="{% url 'vendors:profile' slug=vendor.user.username %}" enctype="multipart/form-data">
          {% csrf_token %}
          {% bootstrap_form update_logo_form %}
          <input type="submit" class="btn btn-primary" name="update_logo" value="Update Logo">
        </form>
      </div>

      <div class="update-cover-image">
        <button type="button" class="btn btn-primary" id="cover-button-show">Edit Cover Image</button>
        <button type="button" class="btn btn-primary" id="cover-button-hide">Close</button>
        <form method="POST" id="cover-form" action="{% url 'vendors:profile' slug=vendor.user.username %}" enctype="multipart/form-data">
          {% csrf_token %}
          {% bootstrap_form update_cover_form %}
          <input type="submit" class="btn btn-primary" name="update_cover" value="Update Cover Image">
        </form>
      </div>
    {% endif %}
  
  
  {% if user.is_customer %}
      <!-- Button trigger modal -->
      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#staticBackdrop">
        Add Vendor to Checklist
      </button>
      <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="staticBackdropLabel">Add Vendor to Checklist</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <form method="POST" action="{% url 'vendors:profile' slug=vendor.user.username %}">
                    {% csrf_token %}    
                    {% bootstrap_form add_checklist_form %}
                    <input type="submit" class="btn btn-primary" 
                    value="Add To Checklist" name="add_to_checklist">
                </form>
            </div>
            </div>
          </div>
        </div>
      </div>   
      <!-- Modal -->
  {% endif %}
    

  <div class="main-info">
    Category: {{vendor.category}}
  </div>
  <hr>
  <div class="address">
    
    <p>Address:</p>
    <span>
      {% if vendor.address %}
        {{vendor.address}}
      {% else %}
        <i>No address provided.</i>
      {% endif %}
    </span> 

    {% if user.is_vendor and vendor.user == user %}
      <button type="button" class="btn btn-primary" id="address-button-show">Edit Address</button>
      <button type="button" class="btn btn-primary" id="address-button-hide">Close</button>
      <form method="POST" id="address-form" action="{% url 'vendors:profile' slug=vendor.user.username %}">
        {% csrf_token %}
        {% bootstrap_form update_address_form %}
        <input type="submit" class="btn btn-primary" name="update_address" value="Update Address">
      </form>
    {% endif %}

  </div>
  <br>


  <div class="contact">
    
    <p>Contact:</p>
    <span>
      {% if vendor.contact %}
        {{vendor.contact}}
      {% else %}
        <i>No contact info provided.</i>
      {% endif %}
    </span> 

    {% if user.is_vendor and vendor.user == user %}
      <button type="button" class="btn btn-primary" id="contact-button-show">Edit Contact</button>
      <button type="button" class="btn btn-primary" id="contact-button-hide">Close</button>
      <form method="POST" id="contact-form" action="{% url 'vendors:profile' slug=vendor.user.username %}">
        {% csrf_token %}
        {% bootstrap_form update_contact_form %}
        <input type="submit" class="btn btn-primary" name="update_contact" value="Update Contact">
      </form>
    {% endif %}

  </div>
  <br>


  <div class="about">
      <h4>About:</h4>
      <span>
        
        {% if vendor.about %}
          {{vendor.about|safe}}
        {% else %}
          <i>No Description.</i>
        {% endif %}
          
        
      </span>
      
      {% if user.is_vendor and vendor.user == user %}
      <button type="button" class="btn btn-primary" id="about-button-show">Edit About</button>
      <button type="button" class="btn btn-primary" id="about-button-hide">Close</button>
      <form method="POST" id="about-form" action="{% url 'vendors:profile' slug=vendor.user.username %}">
        {% csrf_token %}
        {% bootstrap_form update_about_form %}
        <input type="submit" class="btn btn-primary" name="update_about" value="Update About">
      </form>
      {% endif %}
  </div>
  <div class="tag">
    Tags:
    {% for tag in tags %}
      {{tag}}
    {% endfor %} 
    
    {% if user.is_vendor and vendor.user.username == user.username %}
      <button type="button" class="btn btn-primary" id="tag-button-show">Add Tags</button>
      <button type="button" class="btn btn-primary" id="tag-button-hide">Close</button>
      <form method="POST" id="tag-form" action="{% url 'vendors:profile' slug=vendor.user.username %}">
        {% csrf_token %}
        {% bootstrap_form add_tag_form %}
        <input type="submit" class="btn btn-primary" name="add_tag" value="Add">
      </form>
    {% endif %}
  </div>
  <div class="images">
    <h4>Images:</h4>
    <div>
    {% for image in vendor_images %}
      <img src="{{ image.image.url }}" class="vendor_images" width="150" height="150" alt="Vendor Image">
      {% if user.is_vendor and vendor.user == user %}
        <a href="{% url 'vendors:image_delete' pk=image.pk %}" class="icon">
          <span class="material-icons delete">clear</span>
        </a>
      {% endif %}
        
    {% endfor %}
    </div>

    {% if user.is_vendor and vendor.user == user %}
    <form method="POST" id="image-form" action="{% url 'vendors:profile' slug=vendor.user.username %}" enctype="multipart/form-data">
      {% csrf_token %}
      {% bootstrap_form add_image_form %}
      <input type="submit" class="btn btn-primary" name="add_image" value="Add">
    </form>
    {% endif %}
  </div>
  <div class="pricing">
    <h4>Pricing:</h4>
    <div>
      {% for pricing in vendor_pricing %}
        <p>
          {{pricing.description}} &nbsp;&nbsp;&nbsp; Rs. {{pricing.price}}
          {% if user.is_vendor and vendor.user == user %}
            <a href="{% url 'vendors:pricing_delete' pk=pricing.pk %}" class="icon">
              <span class="material-icons delete">clear</span>
            </a>
          {% endif %}
        </p>
      {% endfor %}
      
      {% if user.is_vendor and vendor.user == user %}
      <button type="button" class="btn btn-primary" id="pricing-button-show">Add Pricing</button>
      <button type="button" class="btn btn-primary" id="pricing-button-hide">Close</button>
      <form method="POST" id="pricing-form" action="{% url 'vendors:profile' slug=vendor.user.username %}">
        {% csrf_token %}
        {{add_pricing_form}}
        <input type="submit" class="btn btn-primary" name="add_pricing" value="Add">
      </form>
      {% endif %}
    </div>    
  </div>



    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>

        $(document).ready(function () {

          $("#logo-form").hide();
          $("#logo-button-show").show();
          $("#logo-button-hide").hide();

          $("#cover-form").hide();
          $("#cover-button-show").show();
          $("#cover-button-hide").hide();

          $("#about-form").hide();
          $("#about-button-show").show();
          $("#about-button-hide").hide();

          $("#address-form").hide();
          $("#address-button-show").show();
          $("#address-button-hide").hide();

          $("#contact-form").hide();
          $("#contact-button-show").show();
          $("#contact-button-hide").hide();

          $("#pricing-form").hide();
          $("#pricing-button-show").show();
          $("#pricing-button-hide").hide();

          $("#tag-form").hide();
          $("#tag-button-show").show();
          $("#tag-button-hide").hide();

          $("#logo-button-show").click(function() {
            $("#logo-form").show();
            $("#logo-button-hide").show();
            $("#logo-button-show").hide();
          });

          $("#logo-button-hide").click(function() {
            $("#logo-form").hide();
            $("#logo-button-show").show();
            $("#logo-button-hide").hide();
          });

          $("#cover-button-show").click(function() {
            $("#cover-form").show();
            $("#cover-button-hide").show();
            $("#cover-button-show").hide();
          });

          $("#cover-button-hide").click(function() {
            $("#cover-form").hide();
            $("#cover-button-show").show();
            $("#cover-button-hide").hide();
          });

          $("#about-button-show").click(function() {
            $("#about-form").show();
            $("#about-button-hide").show();
            $("#about-button-show").hide();
          });

          $("#about-button-hide").click(function() {
            $("#about-form").hide();
            $("#about-button-show").show();
            $("#about-button-hide").hide();
          });

          $("#address-button-show").click(function() {
            $("#address-form").show();
            $("#address-button-hide").show();
            $("#address-button-show").hide();
          });

          $("#address-button-hide").click(function() {
            $("#address-form").hide();
            $("#address-button-show").show();
            $("#address-button-hide").hide();
          });

          $("#contact-button-show").click(function() {
            $("#contact-form").show();
            $("#contact-button-hide").show();
            $("#contact-button-show").hide();
          });

          $("#contact-button-hide").click(function() {
            $("#contact-form").hide();
            $("#contact-button-show").show();
            $("#contact-button-hide").hide();
          });

          $("#pricing-button-show").click(function() {
            $("#pricing-form").show();
            $("#pricing-button-hide").show();
            $("#pricing-button-show").hide();
          });

          $("#pricing-button-hide").click(function() {
            $("#pricing-form").hide();
            $("#pricing-button-show").show();
            $("#pricing-button-hide").hide();
          });

          $("#tag-button-show").click(function() {
            $("#tag-form").show();
            $("#tag-button-hide").show();
            $("#tag-button-show").hide();
          });

          $("#tag-button-hide").click(function() {
            $("#tag-form").hide();
            $("#tag-button-show").show();
            $("#tag-button-hide").hide();
          });

        })
    </script>
{% endblock vendor_content %}

